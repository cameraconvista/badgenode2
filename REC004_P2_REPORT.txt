# ===== BADGENODE REC-004 FASE 2 REPORT =====
# Data: 20250914-212527
# RUN_ID: REC004-P2-20250914-212527-3816
# Obiettivo: usare la view "v_timbrature_utenti" per lo storico con una sola query (fallback se non disponibile)

## FILE MODIFICATI
- storico.html
  * Garantito hook globale: window.__REC004__ (se mancava)
- assets/scripts/timbrature-data.js
  * Inserito blocco: [REC004-P2 JOIN attempt] con early-return

## COMPORTAMENTO
- Se mod.fetchStoricoJoin() restituisce { rows: [...] } → usa i dati della JOIN (log: "[REC004] JOIN view attiva: X righe").
- Se qualcosa non va → il codice originale prosegue invariato (fallback automatico).

## COME VALIDARE
1) Apri "storico" come al solito e guarda la console:
   - Atteso con JOIN: "[REC004] JOIN view attiva: N righe (fallback disabilitato)"
   - In fallback: "[REC004] join non disponibile, uso fallback: ..."
2) Verifica:
   - Rendering identico, export PDF/XLSX invariati, CRUD invariati.
   - Nessun errore rosso in console.
3) Confronta tempi di risposta tra JOIN attiva e fallback (facoltativo).

## ROLLBACK
cp -r .backups/REC004_P2_20250914-212527/* ./

# ===== FINE REPORT =====
